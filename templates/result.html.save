<!doctype html>
<html>
   <head>
      <script src="https://d3js.org/d3.v4.min.js"></script>
      <link rel="stylesheet" type="text/css" href="{{url_for("static", filename="style2.css") }} ">   
   </head>
   <body>
      <svg width="620" height="500"></svg>
      <h1>Facebook stock option prices trend</h1>
      <div id="prediction">
         <h2>Prediction for next 3 days</h2>
         <div id=day>
         {% for value in pred[0] %} <p class="dayp"> Day 1: {{value}} $</p>{% endfor %}
         {% for value in pred[1] %} <p class="dayp"> Day 2: {{value}} $</p>{% endfor %}
         {% for value in pred[2] %} <p class="dayp"> Day 3: {{value}} $</p>{% endfor %}
         {% for value in pred[3] %} <p><b>Mean Average Error: </b> {{value}} $</p>{% endfor %}
	 {% for value in pred[4] %} <p><b>Variance Score associated to the model : </b>{{value}} </p>{% endfor %}
	 <p>Explained variance score: 1 is perfect prediction </p>
	 <p id="note">*Predictions based on the daily closing price</p>
         </div>
      </div>
      <table border=2>
            <th class="header"> Date </th>
            <th class="header"> Closing Price($) </th>
               {% for key0 in result[0] %} 
                  <tr> 
                       <td class="cell">{{ result[1][key0] }} </td> 
                       <td class="cell">{{ result[2][key0] }} </td> 
                  </tr>
               {% endfor %}
      </table>
	<script>

		var svg = d3.select("svg"),
		    margin = {top: 20, right: 20, bottom: 30, left: 50},
		    width = +svg.attr("width") - margin.left - margin.right,
		    height = +svg.attr("height") - margin.top - margin.bottom,
		    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

		var parseTime = d3.timeParse("%m/%d/%y");

		var x = d3.scaleTime()
		    .rangeRound([0, width]);

		var y = d3.scaleLinear()
		    .rangeRound([height, 0]);

		var line = d3.line()
		    .x(function(d) { return x(d.date); })
		    .y(function(d) { return y(d.close); });


		d3.csv("{{url}}", function(d) {
		  d.date = parseTime(d.Date);
		  d.close = +d.Close;
		  return d;
		}, function(error, data) {
		  if (error) throw error;

		  x.domain(d3.extent(data, function(d) { return d.date; }));
		  y.domain(d3.extent(data, function(d) { return d.close; }));

		  g.append("g")
		      .attr("transform", "translate(0," + height + ")")
		      .call(d3.axisBottom(x))
		      .append("text")
		      .attr("fill", "#000")
		    //.select(".domain")
		      //.remove();

		  g.append("g")
		      .call(d3.axisLeft(y))
		    .append("text")
		      .attr("fill", "#000")
		      .attr("transform", "rotate(-90)")
		      .attr("y", 6)
		      .attr("dy", "0.71em")
		      .attr("text-anchor", "end")
		      .text("Price ($)");

		  g.append("path")
		      .datum(data)
		      .attr("fill", "none")
		      .attr("stroke", "steelblue")
		      .attr("stroke-linejoin", "round")
		      .attr("stroke-linecap", "round")
		      .attr("stroke-width", 1.5)
		      .attr("d", line);
		});

	</script>
   </body>
</html>
